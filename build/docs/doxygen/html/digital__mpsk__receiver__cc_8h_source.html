<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>GNU Radio 3.6.1git-182-gab9a06f0 C++ API: digital_mpsk_receiver_cc.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>


</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">GNU Radio 3.6.1git-182-gab9a06f0 C++ API
   
   </div>
   
  </td>
  
  
  
   
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('digital__mpsk__receiver__cc_8h.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">digital_mpsk_receiver_cc.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="digital__mpsk__receiver__cc_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/* -*- c++ -*- */</span>
<a name="l00002"></a>00002 <span class="comment">/*</span>
<a name="l00003"></a>00003 <span class="comment"> * Copyright 2004,2007,2011 Free Software Foundation, Inc.</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * This file is part of GNU Radio</span>
<a name="l00006"></a>00006 <span class="comment"> *</span>
<a name="l00007"></a>00007 <span class="comment"> * GNU Radio is free software; you can redistribute it and/or modify</span>
<a name="l00008"></a>00008 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l00009"></a>00009 <span class="comment"> * the Free Software Foundation; either version 3, or (at your option)</span>
<a name="l00010"></a>00010 <span class="comment"> * any later version.</span>
<a name="l00011"></a>00011 <span class="comment"> *</span>
<a name="l00012"></a>00012 <span class="comment"> * GNU Radio is distributed in the hope that it will be useful,</span>
<a name="l00013"></a>00013 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00014"></a>00014 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="l00015"></a>00015 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00016"></a>00016 <span class="comment"> *</span>
<a name="l00017"></a>00017 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00018"></a>00018 <span class="comment"> * along with GNU Radio; see the file COPYING.  If not, write to</span>
<a name="l00019"></a>00019 <span class="comment"> * the Free Software Foundation, Inc., 51 Franklin Street,</span>
<a name="l00020"></a>00020 <span class="comment"> * Boston, MA 02110-1301, USA.</span>
<a name="l00021"></a>00021 <span class="comment"> */</span>
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 <span class="preprocessor">#ifndef INCLUDED_DIGITAL_MPSK_RECEIVER_CC_H</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#define INCLUDED_DIGITAL_MPSK_RECEIVER_CC_H</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="digital__api_8h.html">digital_api.h</a>&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;<a class="code" href="attributes_8h.html">gruel/attributes.h</a>&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;<a class="code" href="gri__control__loop_8h.html">gri_control_loop.h</a>&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;<a class="code" href="gr__block_8h.html">gr_block.h</a>&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;<a class="code" href="gr__complex_8h.html">gr_complex.h</a>&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00032"></a>00032 
<a name="l00033"></a>00033 <span class="keyword">class </span><a class="code" href="classgri__mmse__fir__interpolator__cc.html" title="Compute intermediate samples between signal samples x(k*Ts)This implements a Mininum Mean Squared Err...">gri_mmse_fir_interpolator_cc</a>;
<a name="l00034"></a>00034 
<a name="l00035"></a>00035 <span class="keyword">class </span><a class="code" href="classdigital__mpsk__receiver__cc.html" title="This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization.This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization. It performs carrier frequency and phase locking as well as symbol timing recovery. It works with (D)BPSK, (D)QPSK, and (D)8PSK as tested currently. It should also work for OQPSK and PI/4 DQPSK.">digital_mpsk_receiver_cc</a>;
<a name="l00036"></a>00036 <span class="keyword">typedef</span> <a class="code" href="classboost_1_1shared__ptr.html" title="shared_ptr documentation stub">boost::shared_ptr&lt;digital_mpsk_receiver_cc&gt;</a> <a class="code" href="classboost_1_1shared__ptr.html" title="shared_ptr documentation stub">digital_mpsk_receiver_cc_sptr</a>;
<a name="l00037"></a>00037 
<a name="l00038"></a>00038 <span class="comment">// public constructor</span>
<a name="l00039"></a>00039 <a class="code" href="digital__api_8h.html#ae14969f36ec69051c4b2f13a0db7e9ba">DIGITAL_API</a> <a class="code" href="classboost_1_1shared__ptr.html" title="shared_ptr documentation stub">digital_mpsk_receiver_cc_sptr</a> 
<a name="l00040"></a>00040 <a class="code" href="digital__mpsk__receiver__cc_8h.html#a41e056f958d47947947830cd7f9ce0b3">digital_make_mpsk_receiver_cc</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="defines_8h.html#a52037c938e3c1b126c6277da5ca689d0">M</a>, <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#aba8d93e7526e0cc1f0b3fc861deb8f90" title="Returns current value of theta.">theta</a>, 
<a name="l00041"></a>00041                                <span class="keywordtype">float</span> loop_bw,
<a name="l00042"></a>00042                                <span class="keywordtype">float</span> fmin, <span class="keywordtype">float</span> fmax,
<a name="l00043"></a>00043                                <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#af9dc8afcc73ab90126eb458a8184e9fc" title="Returns current value of mu.">mu</a>, <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#ad038f933471d96568d8fec4b3b74c4fc" title="Returns mu gain factor.">gain_mu</a>, 
<a name="l00044"></a>00044                                <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#aacefc0a2ae7cbbffd0f55c4bff8c3a86" title="Returns current value of omega.">omega</a>, <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#a7e031588dbfad49821ccf648cff9fc1c" title="Returns omega gain factor.">gain_omega</a>, <span class="keywordtype">float</span> omega_rel);
<a name="l00045"></a>00045 <span class="comment"></span>
<a name="l00046"></a>00046 <span class="comment">/*!</span>
<a name="l00047"></a>00047 <span class="comment"> * \brief This block takes care of receiving M-PSK modulated signals</span>
<a name="l00048"></a>00048 <span class="comment"> * through phase, frequency, and symbol synchronization.</span>
<a name="l00049"></a>00049 <span class="comment"> * \ingroup sync_blk</span>
<a name="l00050"></a>00050 <span class="comment"> * \ingroup demod_blk</span>
<a name="l00051"></a>00051 <span class="comment"> * \ingroup digital</span>
<a name="l00052"></a>00052 <span class="comment"> *</span>
<a name="l00053"></a>00053 <span class="comment"> * This block takes care of receiving M-PSK modulated signals through</span>
<a name="l00054"></a>00054 <span class="comment"> * phase, frequency, and symbol synchronization. It performs carrier</span>
<a name="l00055"></a>00055 <span class="comment"> * frequency and phase locking as well as symbol timing recovery.  It</span>
<a name="l00056"></a>00056 <span class="comment"> * works with (D)BPSK, (D)QPSK, and (D)8PSK as tested currently. It</span>
<a name="l00057"></a>00057 <span class="comment"> * should also work for OQPSK and PI/4 DQPSK.</span>
<a name="l00058"></a>00058 <span class="comment"> *</span>
<a name="l00059"></a>00059 <span class="comment"> * The phase and frequency synchronization are based on a Costas loop</span>
<a name="l00060"></a>00060 <span class="comment"> * that finds the error of the incoming signal point compared to its</span>
<a name="l00061"></a>00061 <span class="comment"> * nearest constellation point. The frequency and phase of the NCO are</span>
<a name="l00062"></a>00062 <span class="comment"> * updated according to this error. There are optimized phase error</span>
<a name="l00063"></a>00063 <span class="comment"> * detectors for BPSK and QPSK, but 8PSK is done using a brute-force</span>
<a name="l00064"></a>00064 <span class="comment"> * computation of the constellation points to find the minimum.</span>
<a name="l00065"></a>00065 <span class="comment"> *</span>
<a name="l00066"></a>00066 <span class="comment"> * The symbol synchronization is done using a modified Mueller and</span>
<a name="l00067"></a>00067 <span class="comment"> * Muller circuit from the paper:</span>
<a name="l00068"></a>00068 <span class="comment"> *</span>
<a name="l00069"></a>00069 <span class="comment"> * &quot;G. R. Danesfahani, T. G. Jeans, &quot;Optimisation of modified Mueller</span>
<a name="l00070"></a>00070 <span class="comment"> * and Muller algorithm,&quot; Electronics Letters, Vol. 31, no. 13, 22</span>
<a name="l00071"></a>00071 <span class="comment"> * June 1995, pp. 1032 - 1033.&quot;</span>
<a name="l00072"></a>00072 <span class="comment"> *</span>
<a name="l00073"></a>00073 <span class="comment"> * This circuit interpolates the downconverted sample (using the NCO</span>
<a name="l00074"></a>00074 <span class="comment"> * developed by the Costas loop) every mu samples, then it finds the</span>
<a name="l00075"></a>00075 <span class="comment"> * sampling error based on this and the past symbols and the decision</span>
<a name="l00076"></a>00076 <span class="comment"> * made on the samples. Like the phase error detector, there are</span>
<a name="l00077"></a>00077 <span class="comment"> * optimized decision algorithms for BPSK and QPKS, but 8PSK uses</span>
<a name="l00078"></a>00078 <span class="comment"> * another brute force computation against all possible symbols. The</span>
<a name="l00079"></a>00079 <span class="comment"> * modifications to the M&amp;M used here reduce self-noise.</span>
<a name="l00080"></a>00080 <span class="comment"> *</span>
<a name="l00081"></a>00081 <span class="comment"> */</span>
<a name="l00082"></a>00082 
<a name="l00083"></a><a class="code" href="classdigital__mpsk__receiver__cc.html">00083</a> <span class="keyword">class </span><a class="code" href="digital__api_8h.html#ae14969f36ec69051c4b2f13a0db7e9ba">DIGITAL_API</a> <a class="code" href="classdigital__mpsk__receiver__cc.html" title="This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization.This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization. It performs carrier frequency and phase locking as well as symbol timing recovery. It works with (D)BPSK, (D)QPSK, and (D)8PSK as tested currently. It should also work for OQPSK and PI/4 DQPSK.">digital_mpsk_receiver_cc</a> : <span class="keyword">public</span> <a class="code" href="classgr__block.html" title="The abstract base class for all &#39;terminal&#39; processing blocks.A signal processing flow is constructed ...">gr_block</a>, <span class="keyword">public</span> <a class="code" href="classgri__control__loop.html">gri_control_loop</a>
<a name="l00084"></a>00084 {
<a name="l00085"></a>00085  <span class="keyword">public</span>:
<a name="l00086"></a>00086   ~<a class="code" href="classdigital__mpsk__receiver__cc.html" title="This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization.This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization. It performs carrier frequency and phase locking as well as symbol timing recovery. It works with (D)BPSK, (D)QPSK, and (D)8PSK as tested currently. It should also work for OQPSK and PI/4 DQPSK.">digital_mpsk_receiver_cc</a> ();
<a name="l00087"></a>00087   <span class="keywordtype">void</span> <a class="code" href="classgr__block.html#aa1f2518b5c97126bb015adb9e2027f4a" title="Estimate input requirements given output request.">forecast</a>(<span class="keywordtype">int</span> noutput_items, <a class="code" href="gr__types_8h.html#ab02d0a829d67d39e3ac3163016d3a8be">gr_vector_int</a> &amp;ninput_items_required);
<a name="l00088"></a>00088   <span class="keywordtype">int</span> <a class="code" href="classgr__block.html#a137b93d87dc83bbdb6369d33f4ea8197" title="compute output items from input items">general_work</a> (<span class="keywordtype">int</span> noutput_items,
<a name="l00089"></a>00089                     <a class="code" href="gr__types_8h.html#ab02d0a829d67d39e3ac3163016d3a8be">gr_vector_int</a> &amp;ninput_items,
<a name="l00090"></a>00090                     <a class="code" href="gr__types_8h.html#a9852a3d906d823cb70eb9c29e7f2a43d">gr_vector_const_void_star</a> &amp;input_items,
<a name="l00091"></a>00091                     <a class="code" href="gr__types_8h.html#acd3f499576e769966ea44554b359d949">gr_vector_void_star</a> &amp;output_items);
<a name="l00092"></a>00092 
<a name="l00093"></a>00093 <span class="comment"></span>
<a name="l00094"></a>00094 <span class="comment">  //! Returns the modulation order (M) currently set</span>
<a name="l00095"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#adc3ddd49441ec8a4e2ebac811febb24e">00095</a> <span class="comment"></span>  <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#adc3ddd49441ec8a4e2ebac811febb24e" title="Returns the modulation order (M) currently set.">modulation_order</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_M; }
<a name="l00096"></a>00096 <span class="comment"></span>
<a name="l00097"></a>00097 <span class="comment">  //! Returns current value of theta</span>
<a name="l00098"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#aba8d93e7526e0cc1f0b3fc861deb8f90">00098</a> <span class="comment"></span>  <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#aba8d93e7526e0cc1f0b3fc861deb8f90" title="Returns current value of theta.">theta</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_theta; }
<a name="l00099"></a>00099 <span class="comment"></span>
<a name="l00100"></a>00100 <span class="comment">  //! Returns current value of mu</span>
<a name="l00101"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#af9dc8afcc73ab90126eb458a8184e9fc">00101</a> <span class="comment"></span>  <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#af9dc8afcc73ab90126eb458a8184e9fc" title="Returns current value of mu.">mu</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_mu; }
<a name="l00102"></a>00102 <span class="comment"></span>
<a name="l00103"></a>00103 <span class="comment">  //! Returns current value of omega</span>
<a name="l00104"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#aacefc0a2ae7cbbffd0f55c4bff8c3a86">00104</a> <span class="comment"></span>  <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#aacefc0a2ae7cbbffd0f55c4bff8c3a86" title="Returns current value of omega.">omega</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_omega; }
<a name="l00105"></a>00105 <span class="comment"></span>
<a name="l00106"></a>00106 <span class="comment">  //! Returns mu gain factor</span>
<a name="l00107"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#ad038f933471d96568d8fec4b3b74c4fc">00107</a> <span class="comment"></span>  <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#ad038f933471d96568d8fec4b3b74c4fc" title="Returns mu gain factor.">gain_mu</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_gain_mu; }
<a name="l00108"></a>00108 <span class="comment"></span>
<a name="l00109"></a>00109 <span class="comment">  //! Returns omega gain factor</span>
<a name="l00110"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#a7e031588dbfad49821ccf648cff9fc1c">00110</a> <span class="comment"></span>  <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#a7e031588dbfad49821ccf648cff9fc1c" title="Returns omega gain factor.">gain_omega</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> d_gain_omega; }
<a name="l00111"></a>00111 <span class="comment"></span>
<a name="l00112"></a>00112 <span class="comment">  //! Returns the relative omega limit</span>
<a name="l00113"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#afc4443709faf8521e908a78b6b3b3259">00113</a> <span class="comment"></span>  <span class="keywordtype">float</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#afc4443709faf8521e908a78b6b3b3259" title="Returns the relative omega limit.">gain_omega_rel</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> d_omega_rel; }
<a name="l00114"></a>00114 <span class="comment"></span>
<a name="l00115"></a>00115 <span class="comment">  //! Sets the modulation order (M) currently</span>
<a name="l00116"></a>00116 <span class="comment"></span>  <span class="keywordtype">void</span> set_modulation_order(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="defines_8h.html#a52037c938e3c1b126c6277da5ca689d0">M</a>);
<a name="l00117"></a>00117 <span class="comment"></span>
<a name="l00118"></a>00118 <span class="comment">  //! Sets value of theta</span>
<a name="l00119"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#a3ce3ea9c4f738f43caa865793bda9766">00119</a> <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#a3ce3ea9c4f738f43caa865793bda9766" title="Sets value of theta.">set_theta</a>(<span class="keywordtype">float</span> theta) { d_theta = theta; }
<a name="l00120"></a>00120 <span class="comment"></span>
<a name="l00121"></a>00121 <span class="comment">  //! Sets value of mu</span>
<a name="l00122"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#a8b54df22ac8ab9260a79e5b805d4487e">00122</a> <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#a8b54df22ac8ab9260a79e5b805d4487e" title="Sets value of mu.">set_mu</a> (<span class="keywordtype">float</span> mu) { d_mu = mu; }
<a name="l00123"></a>00123   <span class="comment"></span>
<a name="l00124"></a>00124 <span class="comment">  //! Sets value of omega and its min and max values </span>
<a name="l00125"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#acb44184ada75462c1ebdc3d9a269e697">00125</a> <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#acb44184ada75462c1ebdc3d9a269e697" title="Sets value of omega and its min and max values.">set_omega</a> (<span class="keywordtype">float</span> omega) { 
<a name="l00126"></a>00126     d_omega = omega;
<a name="l00127"></a>00127     d_min_omega = omega*(1.0 - d_omega_rel);
<a name="l00128"></a>00128     d_max_omega = omega*(1.0 + d_omega_rel);
<a name="l00129"></a>00129     d_omega_mid = 0.5*(d_min_omega+d_max_omega);
<a name="l00130"></a>00130   }
<a name="l00131"></a>00131 <span class="comment"></span>
<a name="l00132"></a>00132 <span class="comment">  //! Sets value for mu gain factor</span>
<a name="l00133"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#ac570840c538938e1fd8284211a12772b">00133</a> <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#ac570840c538938e1fd8284211a12772b" title="Sets value for mu gain factor.">set_gain_mu</a> (<span class="keywordtype">float</span> gain_mu) { d_gain_mu = gain_mu; }
<a name="l00134"></a>00134 <span class="comment"></span>
<a name="l00135"></a>00135 <span class="comment">  //! Sets value for omega gain factor</span>
<a name="l00136"></a><a class="code" href="classdigital__mpsk__receiver__cc.html#a1c57b7a442d60b0b757e57657d010492">00136</a> <span class="comment"></span>  <span class="keywordtype">void</span> <a class="code" href="classdigital__mpsk__receiver__cc.html#a1c57b7a442d60b0b757e57657d010492" title="Sets value for omega gain factor.">set_gain_omega</a> (<span class="keywordtype">float</span> gain_omega) { d_gain_omega = gain_omega; }
<a name="l00137"></a>00137 <span class="comment"></span>
<a name="l00138"></a>00138 <span class="comment">  //! Sets the relative omega limit and resets omega min/max values</span>
<a name="l00139"></a>00139 <span class="comment"></span>  <span class="keywordtype">void</span> set_gain_omega_rel(<span class="keywordtype">float</span> omega_rel);
<a name="l00140"></a>00140   
<a name="l00141"></a>00141 <span class="keyword">protected</span>:
<a name="l00142"></a>00142   <span class="comment"></span>
<a name="l00143"></a>00143 <span class="comment">  /*!</span>
<a name="l00144"></a>00144 <span class="comment">   * \brief Constructor to synchronize incoming M-PSK symbols</span>
<a name="l00145"></a>00145 <span class="comment">   *</span>
<a name="l00146"></a>00146 <span class="comment">   * \param M           modulation order of the M-PSK modulation</span>
<a name="l00147"></a>00147 <span class="comment">   * \param theta       any constant phase rotation from the real axis of the constellation</span>
<a name="l00148"></a>00148 <span class="comment">   * \param loop_bw     Loop bandwidth to set gains of phase/freq tracking loop</span>
<a name="l00149"></a>00149 <span class="comment">   * \param fmin        minimum normalized frequency value the loop can achieve</span>
<a name="l00150"></a>00150 <span class="comment">   * \param fmax        maximum normalized frequency value the loop can achieve</span>
<a name="l00151"></a>00151 <span class="comment">   * \param mu          initial parameter for the interpolator [0,1]</span>
<a name="l00152"></a>00152 <span class="comment">   * \param gain_mu     gain parameter of the M&amp;M error signal to adjust mu (~0.05)</span>
<a name="l00153"></a>00153 <span class="comment">   * \param omega       initial value for the number of symbols between samples (~number of samples/symbol)</span>
<a name="l00154"></a>00154 <span class="comment">   * \param gain_omega  gain parameter to adjust omega based on the error (~omega^2/4)</span>
<a name="l00155"></a>00155 <span class="comment">   * \param omega_rel   sets the maximum (omega*(1+omega_rel)) and minimum (omega*(1+omega_rel)) omega (~0.005)</span>
<a name="l00156"></a>00156 <span class="comment">   *</span>
<a name="l00157"></a>00157 <span class="comment">   * The constructor also chooses which phase detector and decision maker to use in the work loop based on the</span>
<a name="l00158"></a>00158 <span class="comment">   * value of M.</span>
<a name="l00159"></a>00159 <span class="comment">   */</span>
<a name="l00160"></a>00160   <a class="code" href="classdigital__mpsk__receiver__cc.html" title="This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization.This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization. It performs carrier frequency and phase locking as well as symbol timing recovery. It works with (D)BPSK, (D)QPSK, and (D)8PSK as tested currently. It should also work for OQPSK and PI/4 DQPSK.">digital_mpsk_receiver_cc</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="defines_8h.html#a52037c938e3c1b126c6277da5ca689d0">M</a>, <span class="keywordtype">float</span> theta, 
<a name="l00161"></a>00161                             <span class="keywordtype">float</span> loop_bw,
<a name="l00162"></a>00162                             <span class="keywordtype">float</span> fmin, <span class="keywordtype">float</span> fmax,
<a name="l00163"></a>00163                             <span class="keywordtype">float</span> mu, <span class="keywordtype">float</span> gain_mu, 
<a name="l00164"></a>00164                             <span class="keywordtype">float</span> omega, <span class="keywordtype">float</span> gain_omega, <span class="keywordtype">float</span> omega_rel);
<a name="l00165"></a>00165 
<a name="l00166"></a>00166   <span class="keywordtype">void</span> make_constellation();
<a name="l00167"></a>00167   <span class="keywordtype">void</span> mm_sampler(<span class="keyword">const</span> <a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> symbol);
<a name="l00168"></a>00168   <span class="keywordtype">void</span> mm_error_tracking(<a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> sample);
<a name="l00169"></a>00169   <span class="keywordtype">void</span> phase_error_tracking(<a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> sample);
<a name="l00170"></a>00170 
<a name="l00171"></a>00171 <span class="comment"></span>
<a name="l00172"></a>00172 <span class="comment">  /*!</span>
<a name="l00173"></a>00173 <span class="comment">   * \brief Phase error detector for MPSK modulations.</span>
<a name="l00174"></a>00174 <span class="comment">   *</span>
<a name="l00175"></a>00175 <span class="comment">   * \param sample   the I&amp;Q sample from which to determine the phase error</span>
<a name="l00176"></a>00176 <span class="comment">   *</span>
<a name="l00177"></a>00177 <span class="comment">   * This function determines the phase error for any MPSK signal by</span>
<a name="l00178"></a>00178 <span class="comment">   * creating a set of PSK constellation points and doing a</span>
<a name="l00179"></a>00179 <span class="comment">   * brute-force search to see which point minimizes the Euclidean</span>
<a name="l00180"></a>00180 <span class="comment">   * distance. This point is then used to derotate the sample to the</span>
<a name="l00181"></a>00181 <span class="comment">   * real-axis and a atan (using the fast approximation function) to</span>
<a name="l00182"></a>00182 <span class="comment">   * determine the phase difference between the incoming sample and</span>
<a name="l00183"></a>00183 <span class="comment">   * the real constellation point</span>
<a name="l00184"></a>00184 <span class="comment">   *</span>
<a name="l00185"></a>00185 <span class="comment">   * This should be cleaned up and made more efficient.</span>
<a name="l00186"></a>00186 <span class="comment">   *</span>
<a name="l00187"></a>00187 <span class="comment">   * \returns the approximated phase error.</span>
<a name="l00188"></a>00188 <span class="comment">   */</span>
<a name="l00189"></a>00189   <span class="keywordtype">float</span> phase_error_detector_generic(<a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> sample) <span class="keyword">const</span>; <span class="comment">// generic for M but more costly</span>
<a name="l00190"></a>00190 <span class="comment"></span>
<a name="l00191"></a>00191 <span class="comment">  /*!</span>
<a name="l00192"></a>00192 <span class="comment">   * \brief Phase error detector for BPSK modulation.</span>
<a name="l00193"></a>00193 <span class="comment">   *</span>
<a name="l00194"></a>00194 <span class="comment">   * \param sample   the I&amp;Q sample from which to determine the phase error</span>
<a name="l00195"></a>00195 <span class="comment">   *</span>
<a name="l00196"></a>00196 <span class="comment">   * This function determines the phase error using a simple BPSK</span>
<a name="l00197"></a>00197 <span class="comment">   * phase error detector by multiplying the real and imaginary (the</span>
<a name="l00198"></a>00198 <span class="comment">   * error signal) components together. As the imaginary part goes to</span>
<a name="l00199"></a>00199 <span class="comment">   * 0, so does this error.</span>
<a name="l00200"></a>00200 <span class="comment">   *</span>
<a name="l00201"></a>00201 <span class="comment">   * \returns the approximated phase error.</span>
<a name="l00202"></a>00202 <span class="comment">   */</span>
<a name="l00203"></a>00203   <span class="keywordtype">float</span> phase_error_detector_bpsk(<a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> sample) <span class="keyword">const</span>;    <span class="comment">// optimized for BPSK</span>
<a name="l00204"></a>00204 <span class="comment"></span>
<a name="l00205"></a>00205 <span class="comment">  /*!</span>
<a name="l00206"></a>00206 <span class="comment">   * \brief Phase error detector for QPSK modulation.</span>
<a name="l00207"></a>00207 <span class="comment">   *</span>
<a name="l00208"></a>00208 <span class="comment">   * \param sample   the I&amp;Q sample from which to determine the phase error</span>
<a name="l00209"></a>00209 <span class="comment">   *</span>
<a name="l00210"></a>00210 <span class="comment">   * This function determines the phase error using the limiter</span>
<a name="l00211"></a>00211 <span class="comment">   * approach in a standard 4th order Costas loop</span>
<a name="l00212"></a>00212 <span class="comment">   *</span>
<a name="l00213"></a>00213 <span class="comment">   * \returns the approximated phase error.</span>
<a name="l00214"></a>00214 <span class="comment">   */</span>
<a name="l00215"></a>00215   <span class="keywordtype">float</span> phase_error_detector_qpsk(<a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> sample) <span class="keyword">const</span>;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="comment"></span>
<a name="l00219"></a>00219 <span class="comment">  /*!</span>
<a name="l00220"></a>00220 <span class="comment">   * \brief Decision maker for a generic MPSK constellation.</span>
<a name="l00221"></a>00221 <span class="comment">   *</span>
<a name="l00222"></a>00222 <span class="comment">   * \param sample   the baseband I&amp;Q sample from which to make the decision</span>
<a name="l00223"></a>00223 <span class="comment">   *</span>
<a name="l00224"></a>00224 <span class="comment">   * This decision maker is a generic implementation that does a</span>
<a name="l00225"></a>00225 <span class="comment">   * brute-force search for the constellation point that minimizes the</span>
<a name="l00226"></a>00226 <span class="comment">   * error between it and the incoming signal.</span>
<a name="l00227"></a>00227 <span class="comment">   *</span>
<a name="l00228"></a>00228 <span class="comment">   * \returns the index to d_constellation that minimizes the error/</span>
<a name="l00229"></a>00229 <span class="comment"> */</span>
<a name="l00230"></a>00230   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> decision_generic(<a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> sample) <span class="keyword">const</span>;
<a name="l00231"></a>00231 
<a name="l00232"></a>00232 <span class="comment"></span>
<a name="l00233"></a>00233 <span class="comment"> /*!</span>
<a name="l00234"></a>00234 <span class="comment">   * \brief Decision maker for BPSK constellation.</span>
<a name="l00235"></a>00235 <span class="comment">   *</span>
<a name="l00236"></a>00236 <span class="comment">   * \param sample   the baseband I&amp;Q sample from which to make the decision</span>
<a name="l00237"></a>00237 <span class="comment">   *</span>
<a name="l00238"></a>00238 <span class="comment">   * This decision maker is a simple slicer function that makes a</span>
<a name="l00239"></a>00239 <span class="comment">   * decision on the symbol based on its placement on the real axis of</span>
<a name="l00240"></a>00240 <span class="comment">   * greater than 0 or less than 0; the quadrature component is always</span>
<a name="l00241"></a>00241 <span class="comment">   * 0.</span>
<a name="l00242"></a>00242 <span class="comment">   *</span>
<a name="l00243"></a>00243 <span class="comment">   * \returns the index to d_constellation that minimizes the error/</span>
<a name="l00244"></a>00244 <span class="comment">   */</span>
<a name="l00245"></a>00245   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> decision_bpsk(<a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> sample) <span class="keyword">const</span>;
<a name="l00246"></a>00246   
<a name="l00247"></a>00247 <span class="comment"></span>
<a name="l00248"></a>00248 <span class="comment">  /*!</span>
<a name="l00249"></a>00249 <span class="comment">   * \brief Decision maker for QPSK constellation.</span>
<a name="l00250"></a>00250 <span class="comment">   *</span>
<a name="l00251"></a>00251 <span class="comment">   * \param sample   the baseband I&amp;Q sample from which to make the decision</span>
<a name="l00252"></a>00252 <span class="comment">   *</span>
<a name="l00253"></a>00253 <span class="comment">   * This decision maker is a simple slicer function that makes a</span>
<a name="l00254"></a>00254 <span class="comment">   * decision on the symbol based on its placement versus both axes</span>
<a name="l00255"></a>00255 <span class="comment">   * and returns which quadrant the symbol is in.</span>
<a name="l00256"></a>00256 <span class="comment">   *</span>
<a name="l00257"></a>00257 <span class="comment">   * \returns the index to d_constellation that minimizes the error/</span>
<a name="l00258"></a>00258 <span class="comment">   */</span>
<a name="l00259"></a>00259   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> decision_qpsk(<a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> sample) <span class="keyword">const</span>;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261 <span class="keyword">private</span>:
<a name="l00262"></a>00262   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d_M;
<a name="l00263"></a>00263   <span class="keywordtype">float</span>        d_theta;
<a name="l00264"></a>00264 <span class="comment"></span>
<a name="l00265"></a>00265 <span class="comment">  /*!</span>
<a name="l00266"></a>00266 <span class="comment">   * \brief Decision maker function pointer </span>
<a name="l00267"></a>00267 <span class="comment">   *</span>
<a name="l00268"></a>00268 <span class="comment">   * \param sample   the baseband I&amp;Q sample from which to make the decision</span>
<a name="l00269"></a>00269 <span class="comment">   *</span>
<a name="l00270"></a>00270 <span class="comment">   * This is a function pointer that is set in the constructor to</span>
<a name="l00271"></a>00271 <span class="comment">   * point to the proper decision function for the specified</span>
<a name="l00272"></a>00272 <span class="comment">   * constellation order.</span>
<a name="l00273"></a>00273 <span class="comment">   *</span>
<a name="l00274"></a>00274 <span class="comment">   * \return index into d_constellation point that is the closest to the recieved sample</span>
<a name="l00275"></a>00275 <span class="comment">   */</span>
<a name="l00276"></a>00276   <span class="keywordtype">unsigned</span> int (<a class="code" href="classdigital__mpsk__receiver__cc.html" title="This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization.This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization. It performs carrier frequency and phase locking as well as symbol timing recovery. It works with (D)BPSK, (D)QPSK, and (D)8PSK as tested currently. It should also work for OQPSK and PI/4 DQPSK.">digital_mpsk_receiver_cc</a>::*d_decision)(<a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> sample) <span class="keyword">const</span>; <span class="comment">// pointer to decision function</span>
<a name="l00277"></a>00277 
<a name="l00278"></a>00278 
<a name="l00279"></a>00279   std::vector&lt;gr_complex&gt; d_constellation;
<a name="l00280"></a>00280   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d_current_const_point;
<a name="l00281"></a>00281 
<a name="l00282"></a>00282   <span class="comment">// Members related to symbol timing</span>
<a name="l00283"></a>00283   <span class="keywordtype">float</span> d_mu, d_gain_mu;
<a name="l00284"></a>00284   <span class="keywordtype">float</span> d_omega, d_gain_omega, d_omega_rel, d_max_omega, d_min_omega, d_omega_mid;
<a name="l00285"></a>00285   <a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> d_p_2T, d_p_1T, d_p_0T;
<a name="l00286"></a>00286   <a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> d_c_2T, d_c_1T, d_c_0T;
<a name="l00287"></a>00287 <span class="comment"></span>
<a name="l00288"></a>00288 <span class="comment">  /*!</span>
<a name="l00289"></a>00289 <span class="comment">   * \brief Phase error detector function pointer </span>
<a name="l00290"></a>00290 <span class="comment">   *</span>
<a name="l00291"></a>00291 <span class="comment">   * \param sample   the I&amp;Q sample from which to determine the phase error</span>
<a name="l00292"></a>00292 <span class="comment">   *</span>
<a name="l00293"></a>00293 <span class="comment">   * This is a function pointer that is set in the constructor to</span>
<a name="l00294"></a>00294 <span class="comment">   * point to the proper phase error detector function for the</span>
<a name="l00295"></a>00295 <span class="comment">   * specified constellation order.</span>
<a name="l00296"></a>00296 <span class="comment">   */</span>
<a name="l00297"></a>00297   float (<a class="code" href="classdigital__mpsk__receiver__cc.html" title="This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization.This block takes care of receiving M-PSK modulated signals through phase, frequency, and symbol synchronization. It performs carrier frequency and phase locking as well as symbol timing recovery. It works with (D)BPSK, (D)QPSK, and (D)8PSK as tested currently. It should also work for OQPSK and PI/4 DQPSK.">digital_mpsk_receiver_cc</a>::*d_phase_error_detector)(<a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> sample) <span class="keyword">const</span>;
<a name="l00298"></a>00298 
<a name="l00299"></a>00299 <span class="comment"></span>
<a name="l00300"></a>00300 <span class="comment">  //! get interpolated value</span>
<a name="l00301"></a>00301 <span class="comment"></span>  <a class="code" href="classgri__mmse__fir__interpolator__cc.html" title="Compute intermediate samples between signal samples x(k*Ts)This implements a Mininum Mean Squared Err...">gri_mmse_fir_interpolator_cc</a>  *d_interp;
<a name="l00302"></a>00302   <span class="comment"></span>
<a name="l00303"></a>00303 <span class="comment">  //! delay line length.</span>
<a name="l00304"></a>00304 <span class="comment"></span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> DLLEN = 8;
<a name="l00305"></a>00305   <span class="comment"></span>
<a name="l00306"></a>00306 <span class="comment">  //! delay line plus some length for overflow protection</span>
<a name="l00307"></a>00307 <span class="comment"></span>  <a class="code" href="attributes_8h.html#a9695b5632261fecaef4b77d4819ce4ad">__GR_ATTR_ALIGNED</a>(8) <a class="code" href="gr__complex_8h.html#aec4bfe41433369afae9327f1b0bc9109">gr_complex</a> d_dl[2*DLLEN];
<a name="l00308"></a>00308   <span class="comment"></span>
<a name="l00309"></a>00309 <span class="comment">  //! index to delay line</span>
<a name="l00310"></a>00310 <span class="comment"></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d_dl_idx;
<a name="l00311"></a>00311 
<a name="l00312"></a>00312   friend <a class="code" href="digital__api_8h.html#ae14969f36ec69051c4b2f13a0db7e9ba">DIGITAL_API</a> <a class="code" href="classboost_1_1shared__ptr.html" title="shared_ptr documentation stub">digital_mpsk_receiver_cc_sptr</a>
<a name="l00313"></a>00313   <a class="code" href="digital__mpsk__receiver__cc_8h.html#a41e056f958d47947947830cd7f9ce0b3">digital_make_mpsk_receiver_cc</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="defines_8h.html#a52037c938e3c1b126c6277da5ca689d0">M</a>, <span class="keywordtype">float</span> theta,
<a name="l00314"></a>00314                                  <span class="keywordtype">float</span> loop_bw,
<a name="l00315"></a>00315                                  <span class="keywordtype">float</span> fmin, <span class="keywordtype">float</span> fmax,
<a name="l00316"></a>00316                                  <span class="keywordtype">float</span> mu, <span class="keywordtype">float</span> gain_mu, 
<a name="l00317"></a>00317                                  <span class="keywordtype">float</span> omega, <span class="keywordtype">float</span> gain_omega, <span class="keywordtype">float</span> omega_rel);
<a name="l00318"></a>00318 };
<a name="l00319"></a>00319 
<a name="l00320"></a>00320 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="digital__mpsk__receiver__cc_8h.html">digital_mpsk_receiver_cc.h</a>      </li>

    <li class="footer">Generated on Tue Jun 5 2012 16:56:54 for GNU Radio 3.6.1git-182-gab9a06f0 C++ API by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
